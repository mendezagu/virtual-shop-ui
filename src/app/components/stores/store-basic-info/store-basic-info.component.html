<div class="mt-5 px-4 sm:px-8 w-full">
  <div class="card">
    <p-messages [(value)]="messages" [enableService]="false" />
  </div>
  <!-- Encabezado -->
  <div class="mb-5">
    <p class="text-sm text-slate-500 mt-1">
      Visualiza y edita los datos principales. Puedes ajustar el rubro y la
      descripción cuando quieras.
    </p>
  </div>

  <!-- Card -->
  <div>
    <!-- Loading skeleton -->
    <ng-container *ngIf="isLoading; else formTpl">
      <div class="p-6 sm:p-10 space-y-4 animate-pulse">
        <div class="h-5 w-1/3 bg-slate-200 rounded"></div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="h-12 bg-slate-200 rounded"></div>
          <div class="h-12 bg-slate-200 rounded"></div>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="h-24 bg-slate-200 rounded"></div>
          <div class="h-12 bg-slate-200 rounded"></div>
        </div>
        <div class="h-10 w-40 bg-slate-200 rounded ml-auto"></div>
      </div>
    </ng-container>

    <!-- Form -->
    <ng-template #formTpl>
      <form [formGroup]="storeForm" (ngSubmit)="saveChanges()" class="">
        <!-- Fila 1: Nombre de la tienda y Rubro -->
        <div class="grid grid-cols-2 gap-4 w-full">
          <!-- NOMBRE TIENDA -->
          <div>
            <label for="nombre_tienda">Nombre de la tienda</label>
            <input
              class="w-full"
              pInputText
              formControlName="nombre_tienda"
              placeholder="Ej: Hamburgueseria ¡Que rico!"
              type="text"
            />
            <div
              class="mt-1 text-xs text-rose-600"
              *ngIf="f['nombre_tienda']?.touched && f['nombre_tienda']?.invalid"
            >
              Debe tener al menos 2 caracteres.
            </div>
          </div>

          <!-- LINK TIENDA -->
          <div>
            <label for="link_tienda">Link de la tienda</label>
            <input
              class="w-full"
              pInputText
              formControlName="link_tienda"
              placeholder="https://mitienda.com"
              type="text"
              readonly
            />
          </div>
        </div>

        <!-- Fila 2: Descripción y Link de la tienda -->
        <div class="flex flex-col">
          <!-- RUBRO -->
          <div class="flex flex-col w-full">
            <label for="rubro">Rubro</label>
            <p-dropdown
              class="w-full"
              [style]="{ width: '100%' }"
              [options]="categories"
              formControlName="rubro"
              optionLabel="name"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              placeholder="Selecciona un rubro"
            >
              <ng-template pTemplate="selectedItem" let-selected>
                <div class="flex items-center gap-2" *ngIf="selected">
                  <img
                    src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                    [class]="'flag flag-' + selected.code.toLowerCase()"
                    style="width: 18px"
                  />
                  <div>{{ selected.name }}</div>
                </div>
              </ng-template>

              <ng-template let-category pTemplate="item">
                <div class="flex items-center gap-2">
                  <img
                    src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                    [class]="'flag flag-' + category.code.toLowerCase()"
                    style="width: 18px"
                  />
                  <div>{{ category.name }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>

          <!-- DESCRIPCIÓN -->
          <div>
            <label for="descripcion">Descripción</label>
            <div class="card">
              <p-editor formControlName="descripcion" [style]="{ height: '320px' }" />
            </div>
            <p class="text-xs text-gray-500">
              Breve descripción para SEO y presentación.
            </p>
          </div>
        </div>

        <!-- Divider sutil -->
        <div
          class="my-4 h-px bg-gradient-to-r from-transparent via-slate-200 to-transparent"
        ></div>

        <!-- Barra de acciones -->
        <div
          class="sticky bottom-0 -mx-6 sm:-mx-10 -mb-6 sm:-mb-10 bg-gradient-to-t from-white via-white to-white/40 px-6 sm:px-10 py-4"
        >
          <div class="flex items-center justify-end gap-2">
            <p-button
              type="button"
              severity="secondary"
              label="Cancelar"
              [outlined]="true"
              [rounded]="true"
              size="small"
            >
         
            </p-button>

            <p-button
              type="submit"
              [disabled]="storeForm.invalid || storeForm.pristine"
              [label]="storeData ? 'Guardar cambios' : 'Crear tienda'"
              severity="success"
              [rounded]="true"
              size="small"
            ></p-button>
          </div>
        </div>
      </form>
    </ng-template>
  </div>
</div>
