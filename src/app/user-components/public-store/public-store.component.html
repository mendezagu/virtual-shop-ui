<div
  class="min-h-[100dvh] bg-[#F9FAFB] text-[#111827] font-[Inter,ui-sans-serif]"
>
  <!-- === LOADING / ERROR === -->
  <div *ngIf="isLoading" class="p-8 text-center text-gray-500 text-lg">
    Cargando tienda‚Ä¶
  </div>

  <div *ngIf="!isLoading && hasError" class="p-8 text-center text-rose-600 text-lg">
    No se pudo cargar la tienda üò¢
  </div>

  <ng-container *ngIf="!isLoading && !hasError">
    <!-- === HEADER TIENDA === -->
    <header
      class="relative w-full max-w-7xl mx-auto bg-white border-b border-gray-200 shadow-sm rounded-b-3xl overflow-hidden"
    >
      <!-- Banner -->
      <div class="relative h-56 sm:h-72 lg:h-80">
        <img
          [src]="store?.portada_url || store?.banner_url || 'https://placehold.co/1200x400?text=Portada'"
          class="absolute inset-0 w-full h-full object-cover"
          alt="Portada tienda"
        />
      </div>

      <!-- Contenido -->
      <div
        class="relative z-10 -mt-12 sm:-mt-16 bg-white rounded-t-3xl shadow-md p-6 sm:p-10 flex flex-col sm:flex-row gap-6 max-w-6xl mx-auto"
      >
        <!-- Logo -->
        <img
          [src]="store?.logo_url || 'https://placehold.co/120x120?text=Logo'"
          alt="Logo tienda"
          class="w-24 h-24 rounded-full border-4 border-white shadow-md object-cover mx-auto sm:mx-0"
        />

        <!-- Info -->
        <div class="flex-1 text-center sm:text-left">
          <h1 class="text-3xl font-semibold text-gray-900">
            {{ store?.nombre_tienda || 'Nombre de la Tienda' }}
          </h1>
          <p
            class="text-gray-600 mt-1 text-sm sm:text-base leading-relaxed"
            [innerHTML]="store?.descripcion"
          ></p>

          <div class="flex items-center justify-center sm:justify-start gap-2 mt-3 text-sm text-gray-700">
            <i class="pi pi-map-marker text-[#008060]"></i>
            {{ store?.direccion || 'Direcci√≥n no especificada' }}
          </div>
        </div>
      </div>
    </header>

    <!-- === INFO SECUNDARIA (HORARIOS / PAGOS / ENV√çOS) === -->
    <section class="max-w-6xl mx-auto mt-10 px-5 sm:px-10 grid sm:grid-cols-3 gap-6">
      <!-- HORARIOS -->
      <div class="bg-white p-5 rounded-2xl shadow-sm border">
        <h3 class="text-lg font-semibold text-[#008060] mb-3 flex items-center gap-2">
          <i class="pi pi-calendar-clock"></i> Horarios
        </h3>
        <ul class="text-sm text-gray-700 space-y-1">
          <li>
            <span class="font-medium">Ma√±ana:</span>
            {{ store?.horario_apertura_manana }} - {{ store?.horario_cierre_manana }}
          </li>
          <li>
            <span class="font-medium">Tarde:</span>
            {{ store?.horario_apertura_tarde }} - {{ store?.horario_cierre_tarde }}
          </li>
        </ul>
      </div>

      <!-- PAGOS -->
      <div class="bg-white p-5 rounded-2xl shadow-sm border">
        <h3 class="text-lg font-semibold text-[#008060] mb-3 flex items-center gap-2">
          <i class="pi pi-credit-card"></i> Medios de pago
        </h3>
        <div class="flex flex-wrap gap-3">
          <span
            *ngFor="let metodo of store?.metodos_pago"
            class="flex items-center gap-2 bg-green-50 text-gray-800 px-3 py-1.5 rounded-full text-sm font-medium border border-green-100 shadow-sm"
          >
            <i [class]="'pi ' + getPaymentIcon(metodo)"></i>
            {{ formatPaymentMethod(metodo) }}
          </span>
        </div>
      </div>

      <!-- ENV√çOS -->
      <div class="bg-white p-5 rounded-2xl shadow-sm border">
        <h3 class="text-lg font-semibold text-[#008060] mb-3 flex items-center gap-2">
          <i class="pi pi-truck"></i> Env√≠os y retiros
        </h3>
        <div class="flex flex-wrap gap-3">
          <span
            *ngFor="let log of store?.logistica"
            class="flex items-center gap-2 bg-blue-50 text-gray-800 px-3 py-1.5 rounded-full text-sm font-medium border border-blue-100 shadow-sm"
          >
            <i [class]="'pi ' + getLogisticIcon(log)"></i>
            {{ formatLogisticMethod(log) }}
          </span>
        </div>
      </div>
    </section>

    <!-- === MAPA === -->
    <section class="max-w-6xl mx-auto mt-10 px-5 sm:px-10">
      <h3 class="text-xl font-semibold text-gray-900 mb-3">Ubicaci√≥n</h3>
      <div id="storeMap" class="w-full h-80 rounded-2xl overflow-hidden shadow-md border"></div>
    </section>

    <!-- === CATEGOR√çAS === -->
    <main class="max-w-7xl mx-auto px-5 sm:px-10 py-12">
      <!-- DESTACADAS -->
      <section *ngIf="featuredCategories.length > 0" class="mb-12">
        <h3 class="text-2xl font-semibold text-[#008060] mb-6">
          Categor√≠as destacadas ‚ú®
        </h3>

        <div
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <a
            *ngFor="let cat of featuredCategories"
            [routerLink]="['/store', slug, 'categoria', cat.slug]"
            class="group relative flex flex-col justify-between rounded-2xl overflow-hidden shadow-md hover:shadow-xl bg-gradient-to-br from-[#f9fafb] to-white border border-gray-200 hover:-translate-y-[3px] transition-all duration-300"
          >
            <div class="p-5 flex flex-col items-center text-center">
              <img
                [src]="cat.imageUrl || getCategoryImage(cat) || 'https://placehold.co/120x120?text=Img'"
                alt="{{ cat.name }}"
                class="w-20 h-20 mb-4 rounded-xl object-cover shadow-sm group-hover:scale-105 transition-transform duration-300"
              />
              <h4
                class="font-semibold text-gray-900 text-lg group-hover:text-[#008060]"
              >
                {{ cat.name }}
              </h4>
              <p class="text-sm text-gray-500 mt-1">
                {{ cat.subcategories?.length || 0 }} subcategor√≠as
              </p>
            </div>

            <span
              class="absolute top-3 right-3 text-xs font-semibold bg-[#008060] text-white px-2.5 py-1 rounded-full shadow-sm"
            >
              {{ cat.type | titlecase }}
            </span>
          </a>
        </div>
      </section>

      <!-- NORMALES -->
      <section>
        <h3 class="text-2xl font-semibold text-gray-800 mb-6">
          Comprar por categor√≠a
        </h3>

        <div
          class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4"
        >
          <a
            *ngFor="let cat of visibleNormalCategories"
            [routerLink]="['/store', slug, 'categoria', cat.slug]"
            class="group flex flex-col items-center justify-center p-4 border rounded-xl bg-white hover:bg-gray-50 transition-all text-center shadow-sm hover:shadow-md hover:-translate-y-[2px]"
          >
            <img
              [src]="cat.imageUrl || getCategoryImage(cat) || 'https://placehold.co/80x80?text=Img'"
              alt="{{ cat.name }}"
              class="w-14 h-14 mb-2 rounded-md object-cover group-hover:scale-105 transition-transform duration-300"
            />
            <span
              class="text-sm font-medium text-gray-700 group-hover:text-[#008060]"
            >
              {{ cat.name }}
            </span>
          </a>
        </div>

        <!-- Bot√≥n Ver m√°s -->
        <div class="flex justify-center mt-8">
          <button
            *ngIf="!allCategoriesLoaded()"
            (click)="loadMoreCategories()"
            class="px-6 py-2.5 rounded-full font-medium text-white bg-[#008060] hover:bg-[#00684A] transition-all shadow-sm text-sm"
          >
            Ver m√°s categor√≠as
          </button>
        </div>
      </section>

      <!-- === PRODUCTOS === 
      <section class="mt-16">
        <h3 class="text-2xl font-semibold text-gray-900 mb-6">
          Nuestros productos
        </h3>

        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
          <div
            *ngFor="let p of store?.products"
            class="bg-white rounded-2xl shadow-sm border hover:shadow-lg transition-all p-4 flex flex-col"
          >
            <img
              [src]="p.imagen_url[0] || 'https://placehold.co/300x300?text=Producto'"
              alt="{{ p.nombre_producto }}"
              class="w-full h-48 object-cover rounded-xl mb-3"
            />
            <h4 class="text-gray-900 font-medium text-base">
              {{ p.nombre_producto }}
            </h4>
            <p class="text-sm text-gray-500 mb-2 line-clamp-2">
              {{ p.descripcion }}
            </p>
            <span class="text-lg font-semibold text-[#008060] mb-3">
              {{ p.precio | currency: 'ARS':'symbol-narrow':'1.0-0' }}
            </span>
            <button
              pButton
              label="Agregar al carrito"
              icon="pi pi-shopping-cart"
              class="mt-auto rounded-full bg-[#008060] hover:bg-[#00684A] text-white text-sm font-semibold shadow-md py-2"
            ></button>
          </div>
        </div>
      </section> -->
    </main>

    <!-- FOOTER -->
    <footer class="text-center text-gray-500 py-8 border-t text-sm mt-10">
      ¬© {{ currentYear }} {{ store?.nombre_tienda }} ‚Äî Todos los derechos reservados.
    </footer>
  </ng-container>
</div>
