<!-- category-products.component.html -->
<section class="max-w-6xl mx-auto px-4 sm:px-8 py-6">
<div class="relative mb-4">
  <!-- Botón Izquierda -->
  <button
    type="button"
    style="right: 21rem;"
    class="absolute top-1/2 -translate-y-1/2 z-10 md:hidden  p-1"
    (click)="scrollChips(-200)"
  >
    <mat-icon class="text-sm">arrow_back_ios</mat-icon>
  </button>

  <!-- Carrusel de chips -->
  <div #chipCarousel class="chip-scroll-wrap overflow-x-auto flex-nowrap flex gap-2 scroll-smooth px-8">
    <button
      class="px-3 py-1.5 rounded-full border text-sm flex-shrink-0"
      [class.bg-emerald-500]="!categorySlug"
      [class.text-white]="!categorySlug"
      (click)="selectCategory('')"
    >
      Todos
    </button>

    <button
      *ngFor="let c of categories"
      class="px-3 py-1.5 rounded-full border text-sm whitespace-nowrap flex-shrink-0"
      [class.bg-emerald-500]="c.slug === categorySlug"
      [class.text-white]="c.slug === categorySlug"
      (click)="selectCategory(c.slug)"
    >
      {{ c.name }} ({{ c.count }})
    </button>
  </div>

  <!-- Botón Derecha -->
  <button
    type="button"
    style="left: 21.5rem"
    class="absolute top-1/2 -translate-y-1/2 z-10 md:hidden  p-1"
    (click)="scrollChips(200)"
  >
    <mat-icon class="text-sm">arrow_forward_ios</mat-icon>
  </button>
</div>








  <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-4">
    <h1 class="text-2xl font-semibold text-slate-800">
      Categoría: {{ meta?.categoria || (categorySlug | titlecase) }}
    </h1>

    <div *ngIf="isLoading" class="text-slate-500 mt-4">Cargando…</div>
    <div *ngIf="!isLoading && hasError" class="text-rose-600 mt-4">
      Error al cargar.
    </div>
    <div
      *ngIf="!isLoading && !hasError && products.length === 0"
      class="text-slate-500 mt-4"
    >
      No hay productos en esta categoría.
    </div>

    <div
      *ngIf="!isLoading && !hasError && products.length"
      class="space-y-3 md:grid md:grid-cols-3 xl:grid-cols-4 md:gap-4 md:space-y-0 mt-4"
    >
      <article
        *ngFor="let p of products"
        [routerLink]="['/producto', p.id_producto]"
        class="flex md:block items-center gap-3 rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden hover:shadow-md transition"
      >
        <!-- Texto -->
        <div class="flex-1 p-2 md:p-3">
          <h3 class="text-md font-semibold line-clamp-1 text-gray-800">
            {{ p.nombre_producto }}
          </h3>
          <span class="text-gray-500">
            {{ p.descripcion }}
          </span>
          <p class="text-base font-bold text-slate-900 mt-1 md:mt-2">
            {{
          p.presentacion_multiple
            ? (p.variants?.[0]?.precio || p.precio)
            : (p.precio | currency: 'ARS':'symbol-narrow':'1.0-0')
            }}
          </p>
        </div>
        <!-- Imagen -->
        <img
          [src]="
            (p.imagen_url && p.imagen_url[0]) ||
            'https://placehold.co/600x400?text=Producto'
          "
          [alt]="p.nombre_producto"
          class="mr-2 h-20 w-20 md:h-40 md:w-full object-cover rounded-lg md:rounded-none shrink-0"
        />
      </article>
    </div>

    <div *ngIf="meta?.totalPages > 1" class="flex items-center gap-2 mt-6">
      <button
        class="px-3 py-1.5 rounded border"
        (click)="prevPage()"
        [disabled]="page === 1"
      >
        Anterior
      </button>
      <span class="text-sm text-slate-600"
        >Página {{ page }} de {{ meta?.totalPages }}</span
      >
      <button
        class="px-3 py-1.5 rounded border"
        (click)="nextPage()"
        [disabled]="page === meta?.totalPages"
      >
        Siguiente
      </button>
    </div>
  </div>
</section>
