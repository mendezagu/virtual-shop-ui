<div class="flex flex-col min-h-[100dvh] bg-neutral-50">

    <!--  Encabezado -->
  <app-page-header
    title="Mis tienda"
    subtitle="Espacio exlusivo para la gestion de tu tienda "
    icon="pi pi-shop"
  ></app-page-header>

  <main class="flex-1 relative w-full">
    <div class="mx-auto p-4 sm:p-6 lg:p-8 transition-all duration-300">
      <!--  Tabs horizontales (desktop) -->
      <p-tabView
        [(activeIndex)]="activeStepIndex"
        class="rounded-2xl shadow-sm bg-white overflow-hidden border border-slate-200 hidden md:block"
      >
        <p-tabPanel header="Informaci贸n b谩sica">
          <app-basic-store-info (saved)="onBasicInfoSaved($event)"></app-basic-store-info>
        </p-tabPanel>

        
        <p-tabPanel header="Pagos y log铆stica">
          <app-store-bank-account
            (back)="goPrev()"
            (saved)="onStepSaved()"
          ></app-store-bank-account>
        </p-tabPanel>

        <p-tabPanel header="Contacto">
          <app-store-contact
            [storeData]="storeData"
            (saved)="onStepSaved()"
            (back)="goPrev()"
          ></app-store-contact>
        </p-tabPanel>

        <p-tabPanel header="Ubicaci贸n y horarios">
          <app-store-ubication-schedule
            [storeData]="storeData"
            (saved)="onStepSaved()"
            (back)="goPrev()"
          ></app-store-ubication-schedule>
        </p-tabPanel>

        <p-tabPanel header="Personalizaci贸n">
          <app-store-personalization
            [storeData]="storeData"
            (back)="goPrev()"
            (saved)="onStepSaved()"
          ></app-store-personalization>
        </p-tabPanel>
      </p-tabView>

      <!--  Stepper vertical (mobile) -->
      <div class="md:hidden">
        <div class="mb-6">
          <h1 class="text-2xl font-semibold text-slate-800">
            {{ stepTitles[activeStepIndex] }}
          </h1>
          <p class="text-sm text-slate-500">
            {{ stepSubtitles[activeStepIndex] }}
          </p>
        </div>

        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm relative">
          <ng-container [ngSwitch]="activeStepIndex">
            <app-basic-store-info
              *ngSwitchCase="0"
              (saved)="onBasicInfoSaved($event)"
            ></app-basic-store-info>


          <app-store-bank-account
           *ngSwitchCase="1"
            (back)="goPrev()"
            (saved)="onStepSaved()"
          ></app-store-bank-account>

            <app-store-contact
              *ngSwitchCase="2"
              [storeData]="storeData"
              (saved)="onStepSaved()"
              (back)="goPrev()"
            ></app-store-contact>

            <app-store-ubication-schedule
              *ngSwitchCase="3"
              [storeData]="storeData"
              (saved)="onStepSaved()"
              (back)="goPrev()"
            ></app-store-ubication-schedule>

            <app-store-personalization
              *ngSwitchCase="4"
              [storeData]="storeData"
              (back)="goPrev()"
              (saved)="onStepSaved()"
            ></app-store-personalization>
          </ng-container>
        </div>
      </div>
    </div>

    <!--  FAB (solo mobile) -->
    <button
      (click)="openMobileSteps()"
      class="fixed bottom-6 right-6 md:hidden rounded-full bg-gradient-to-r from-pink-500 to-purple-600 p-4 shadow-lg text-white hover:opacity-90 focus:outline-none focus:ring-4 focus:ring-pink-200 transition"
      aria-label="Abrir pasos"
    >
      <i class="pi pi-bars text-lg"></i>
    </button>

    <!-- Overlay m贸vil -->
    <div
      *ngIf="mobileStepsOpen"
      class="fixed inset-0 bg-black/40 z-40 md:hidden"
      (click)="closeMobileSteps()"
    ></div>

    <!--  Stepper lateral en mobile -->
    <div
      *ngIf="mobileStepsOpen"
      class="fixed top-0 left-0 h-full w-72 bg-white shadow-lg z-50 p-6 transition-transform transform md:hidden"
    >
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-lg font-bold text-slate-800">Pasos</h2>
        <button (click)="closeMobileSteps()" aria-label="Cerrar">
          <i class="pi pi-times text-slate-500 hover:text-slate-700"></i>
        </button>
      </div>

      <ul class="space-y-3">
        <li
          *ngFor="let step of stepTitles; let i = index"
          (click)="activeStepIndex = i; closeMobileSteps()"
          class="flex items-center gap-3 p-2 rounded-lg cursor-pointer transition"
          [ngClass]="
            activeStepIndex === i
              ? 'bg-pink-100 text-pink-700 font-medium'
              : 'text-slate-600 hover:bg-slate-100'
          "
        >
          <i
            class="pi text-sm"
            [ngClass]="{
              'pi-info-circle': i === 0,
              'pi-phone': i === 1,
              'pi-map-marker': i === 2,
              'pi-palette': i === 3
            }"
          ></i>
          <span>{{ step }}</span>
        </li>
      </ul>
    </div>
  </main>
</div>
