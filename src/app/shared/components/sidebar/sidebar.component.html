<aside
  [ngClass]="[
    collapsed ? 'w-20' : 'w-72',
    'fixed top-0 left-0 h-screen flex flex-col transition-all duration-300 border-r shadow-[0_4px_20px_rgba(0,0,0,0.3)] overflow-y-auto',
    mode === 'seller'
      ? 'bg-gradient-to-b from-[#0b132b] via-[#0f172a] to-[#111827] text-slate-200 border-slate-800'
      : 'text-[var(--text)]'
  ]"
  [style.backgroundColor]="
    mode === 'buyer'
      ? (store?.background_color === 'dark'
          ? '#202123'
          : store?.background_color || '#ffffff')
      : ''
  "
  [style.color]="mode === 'buyer' ? (store?.background_color === 'dark' ? '#f5f5f5' : '#111827') : ''"
  [style.--primary]="store?.primary_color || '#7e22ce'"
  [style.--secondary]="store?.secondary_color || '#ec4899'"
>
  <!-- üîπ HEADER -->
  <div
    class="flex items-center gap-3 px-4 py-4 border-b border-slate-700
           bg-gradient-to-r from-[var(--secondary)] to-[var(--primary)]
           text-white shadow-md rounded-br-2xl"
  >
    <ng-container *ngIf="mode === 'buyer' && store?.logo_url; else defaultIcon">
      <img
        [src]="store.logo_url"
        alt="Logo"
        class="w-12 h-12 rounded-xl object-cover border border-white/20 bg-white shadow-sm"
      />
    </ng-container>

    <ng-template #defaultIcon>
      <div
        class="h-12 w-12 rounded-xl flex items-center justify-center text-white
               bg-gradient-to-tr from-[var(--secondary)] to-[var(--primary)] shadow-inner"
      >
        <i class="pi pi-shop text-lg"></i>
      </div>
    </ng-template>

    <div *ngIf="!collapsed" class="overflow-hidden">
      <p class="text-xs opacity-80 m-0 leading-tight">
        {{ mode === 'seller' ? 'Bienvenido' : 'Visitando' }}
      </p>
      <h3 class="text-sm font-semibold truncate">
        {{ mode === 'seller' ? 'Panel del vendedor' : store?.nombre_tienda || 'Tienda' }}
      </h3>
    </div>
  </div>

  <!-- üîπ SELLER MODE -->
  <ng-container *ngIf="mode === 'seller'">
    <ul class="flex-1 flex flex-col gap-1 px-3 py-3">
      <li *ngFor="let item of sellerItems">
        <a
          (click)="item.action()"
          pRipple
          [attr.id]="'tour-' + item.id"
          class="group flex items-center gap-3 p-3 rounded-xl cursor-pointer select-none
                 transition-all duration-200 text-slate-300
                 hover:bg-gradient-to-r hover:from-[var(--secondary)]/20 hover:to-[var(--primary)]/20"
        >
          <div
            class="h-9 w-9 flex items-center justify-center rounded-lg transition-all duration-200
                   bg-gradient-to-tr from-slate-700/30 to-slate-600/20 text-[var(--secondary)]
                   group-hover:bg-gradient-to-tr group-hover:from-[var(--secondary)]
                   group-hover:to-[var(--primary)] group-hover:text-white"
          >
            <i [class]="item.icon"></i>
          </div>
          <span *ngIf="!collapsed" class="font-medium text-sm transition-all duration-300 truncate">
            {{ item.text }}
          </span>
        </a>
      </li>

      <!-- üî∏ Logout -->
      <li>
        <a
          (click)="logout()"
          pRipple
          class="flex items-center gap-3 p-3 rounded-xl cursor-pointer text-slate-300
                 hover:bg-gradient-to-r hover:from-red-500/20 hover:to-red-400/10 transition-all"
        >
          <div class="h-9 w-9 flex items-center justify-center rounded-lg bg-red-500/20 text-red-400">
            <i class="pi pi-sign-out"></i>
          </div>
          <span *ngIf="!collapsed" class="font-medium text-sm">Cerrar sesi√≥n</span>
        </a>
      </li>
    </ul>

    <!-- üîπ FOOTER -->
    <div class="px-4 pb-4" *ngIf="!collapsed">
      <div
        class="rounded-xl border border-slate-700 bg-slate-800/70
               backdrop-blur-md p-3 text-xs text-slate-400
               flex items-center justify-between shadow-sm"
      >
        <span>Estado</span>
        <span
          class="inline-flex items-center gap-1 rounded-full bg-emerald-100/10 text-emerald-400
                 border border-emerald-500/20 px-2 py-0.5"
        >
          <span class="h-2 w-2 rounded-full bg-emerald-400 animate-pulse"></span>
          Activo
        </span>
      </div>
    </div>
  </ng-container>

  <!-- üîπ BUYER MODE -->
  <ng-container *ngIf="mode === 'buyer' && store">
    <ul class="flex-1 flex flex-col gap-1 px-3 py-3">
      <li
        *ngFor="let item of [
          { icon: 'pi pi-phone', title: 'Contacto', lines: [store?.telefono_contacto, store?.email] },
          { icon: 'pi pi-map-marker', title: 'Ubicaci√≥n', lines: [store?.direccion, store?.ciudad + ' (' + store?.provincia + ')'] },
          { icon: 'pi pi-clock', title: 'Horarios', lines: [store?.horario_apertura + ' - ' + store?.horario_cierre] }
        ]"
      >
        <div class="flex items-center gap-3 p-3 rounded-xl transition hover:bg-[var(--secondary)]/10">
          <div
            class="h-9 w-9 flex items-center justify-center rounded-lg
                   bg-gradient-to-tr from-[var(--secondary)] to-[var(--primary)]
                   text-white shadow-sm"
          >
            <i [class]="item.icon"></i>
          </div>
          <div *ngIf="!collapsed" class="flex flex-col text-sm">
            <span class="font-medium">{{ item.title }}</span>
            <ng-container *ngFor="let line of item.lines">
              <span *ngIf="line" class="opacity-80">{{ line }}</span>
            </ng-container>
          </div>
        </div>
      </li>
    </ul>
  </ng-container>
</aside>
